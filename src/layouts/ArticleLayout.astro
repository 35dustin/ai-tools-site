---
import BaseLayout from './BaseLayout.astro';
import Sidebar from '../components/Sidebar.astro';

interface Props {
  title: string;
  description: string;
  image?: string;
  publishDate: string;
  updateDate?: string;
  author?: string;
  category: string;
  readTime?: string;
}

const {
  title,
  description,
  image,
  publishDate,
  updateDate,
  author = 'AI Tools Review Team',
  category,
  readTime = '8 min read',
} = Astro.props;

const jsonLd = {
  '@context': 'https://schema.org',
  '@type': 'Article',
  headline: title,
  description,
  image: image ? new URL(image, Astro.site).toString() : undefined,
  datePublished: publishDate,
  dateModified: updateDate || publishDate,
  author: { '@type': 'Organization', name: 'AI Tools Review' },
  publisher: {
    '@type': 'Organization',
    name: 'AI Tools Review',
    url: Astro.site?.toString(),
  },
};
---

<BaseLayout title={title} description={description} image={image} type="article" publishDate={publishDate}>
  <Fragment slot="head">
    <script type="application/ld+json" set:html={JSON.stringify(jsonLd)} />
  </Fragment>

  <article class="max-w-7xl mx-auto px-4 sm:px-6 py-8 sm:py-12">
    <div class="lg:grid lg:grid-cols-[1fr_300px] lg:gap-10">
      <div>
        <!-- Article Header -->
        <header class="mb-8">
          <div class="flex items-center gap-3 mb-4">
            <a href={`/${category}`} class="text-xs font-semibold uppercase tracking-wider text-accent bg-accent/10 px-3 py-1 rounded-full">
              {category.replace('-', ' ')}
            </a>
            <span class="text-text-muted text-sm">{readTime}</span>
          </div>
          <h1 class="text-3xl sm:text-4xl lg:text-5xl font-extrabold leading-tight mb-4">{title}</h1>
          <p class="text-lg text-text-secondary mb-4">{description}</p>
          <div class="flex items-center gap-4 text-sm text-text-muted border-b border-border pb-6">
            <span>By {author}</span>
            <span>Published {new Date(publishDate).toLocaleDateString('en-US', { month: 'long', day: 'numeric', year: 'numeric' })}</span>
            {updateDate && <span>Updated {new Date(updateDate).toLocaleDateString('en-US', { month: 'long', day: 'numeric', year: 'numeric' })}</span>}
          </div>
        </header>

        <!-- Article Body -->
        <div class="prose prose-invert prose-lg max-w-none
          [&_h2]:text-2xl [&_h2]:font-bold [&_h2]:mt-10 [&_h2]:mb-4 [&_h2]:text-text-primary
          [&_h3]:text-xl [&_h3]:font-semibold [&_h3]:mt-8 [&_h3]:mb-3 [&_h3]:text-text-primary
          [&_p]:text-text-secondary [&_p]:mb-4 [&_p]:leading-relaxed
          [&_ul]:text-text-secondary [&_ul]:mb-4 [&_ul]:pl-6 [&_ul]:list-disc
          [&_ol]:text-text-secondary [&_ol]:mb-4 [&_ol]:pl-6 [&_ol]:list-decimal
          [&_li]:mb-2
          [&_strong]:text-text-primary [&_strong]:font-semibold
          [&_a]:text-accent-light [&_a:hover]:text-accent
          [&_blockquote]:border-l-4 [&_blockquote]:border-accent [&_blockquote]:pl-4 [&_blockquote]:italic [&_blockquote]:text-text-muted
          [&_table]:w-full [&_table]:border-collapse [&_table]:my-6
          [&_th]:bg-bg-secondary [&_th]:border [&_th]:border-border [&_th]:px-4 [&_th]:py-2 [&_th]:text-left [&_th]:font-semibold
          [&_td]:border [&_td]:border-border [&_td]:px-4 [&_td]:py-2 [&_td]:text-text-secondary
          [&_hr]:border-border [&_hr]:my-8">
          <slot />
        </div>

        <!-- Affiliate Disclosure -->
        <aside class="mt-10 p-4 bg-bg-secondary border border-border rounded-lg text-sm text-text-muted">
          <strong class="text-text-secondary">Disclosure:</strong> Some links in this article are affiliate links. We may earn a commission at no extra cost to you if you purchase through our links. This does not influence our editorial integrity.
          <a href="/disclosure" class="underline">Read our full disclosure</a>.
        </aside>
      </div>

      <Sidebar />
    </div>
  </article>
</BaseLayout>
